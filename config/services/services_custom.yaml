services:
    TCPDF:
        class: TCPDF
        public: false

    App\Service\genererPdf\HeaderFooterAcPdf:
        class: App\Service\genererPdf\HeaderFooterAcPdf
        public: false

    PHPMailer\PHPMailer\PHPMailer:
        class: PHPMailer\PHPMailer\PHPMailer
        public: false # C'est une dépendance, pas besoin de le rendre public

    App\Service\TwigMailerService:
        arguments:
            $phpMailer: '@PHPMailer\PHPMailer\PHPMailer' # Assumes PHPMailer is registered as a service
            $twigEnvironment: '@Twig\Environment'
            $assetFolder: '%kernel.project_dir%/public'

    App\Service\EmailService:
        arguments:
            $twig: '@Twig\Environment'
            $mailerHost: '%mailer.host%'
            $mailerUser: '%mailer.user%'
            $mailerPass: '%mailer.password%'
            $mailerPort: '%mailer.port%'
            $fromEmail: '%mailer.from_email%'
            $fromName: '%mailer.from_name%'
            $bccRecipients: '%mailer.bcc_recipients%'

    # Services spécifiques
    App\Service\ExcelService:
        public: true

    App\Service\FusionPdf:
        arguments:
            $fpdi: '@setasign\Fpdi\Tcpdf\Fpdi'
        public: true

    App\Service\SessionManagerService:
        public: true

    # Services de navigation
    App\Service\navigation\MenuService:
        autowire: false
        arguments:
            - '@doctrine.orm.default_entity_manager'
            - '@App\Service\SessionManagerService'
            - '%env(BASE_PATH_FICHIER_COURT)%'
        public: true

    App\Service\navigation\BreadcrumbMenuService:
        autowire: false
        arguments:
            - '@App\Service\navigation\MenuService'
        public: true

    App\Service\historiqueOperation\HistoriqueOperationDevisMagasinService:
        arguments:
            - '@doctrine.orm.default_entity_manager'
        public: true

    # ✅ NOUVELLES CONFIGURATIONS - Ajouter à la fin du fichier
    # Services problématiques qui nécessitent une configuration
    App\Service\genererPdf\GeneratePdfDevisMagasin:
        arguments:
            $baseCheminDuFichier: '%env(BASE_PATH_FICHIER)%/'
            $baseCheminDocuware: '%env(BASE_PATH_DOCUWARE)%/'
        public: true

    App\Service\fichier\UploderFileService:
        arguments:
            $cheminDeBase: '%env(BASE_PATH_FICHIER)%/magasin/devis/'
        public: true

    App\Service\da\FileUploaderForDAService:
        arguments:
            $basePath: '%env(BASE_PATH_FICHIER)%'

    App\Service\docuware\CopyDocuwareService:
        arguments:
            $docuwareFtpPath: '%docuware.ftp_path%'

    App\Service\fichier\FileUploaderService:
        arguments:
            $targetDirectory: '%upload_directory%'
            $fusionPdf: '@App\Service\FusionPdf'

    # Services avec injection de dépendance corrigée
    App\Service\AncienDitService:
        arguments:
            $em: '@doctrine.orm.default_entity_manager'
            $ditModel: '@App\Model\dit\DitModel'
            $genererPdfDit: '@App\Service\genererPdf\GenererPdfDit'
            $fusionPdf: '@App\Service\FusionPdf'
        public: true

    App\Service\genererPdf\GenererPdfDit:
        arguments:
            $tcpdf: '@TCPDF'
            $baseCheminDuFichier: '%env(BASE_PATH_FICHIER)%/'
            $baseCheminDocuware: '%env(BASE_PATH_DOCUWARE)%/'
        public: true

    # Service FPDI pour la fusion de PDF
    setasign\Fpdi\Tcpdf\Fpdi:
        class: setasign\Fpdi\Tcpdf\Fpdi
        public: false

    # Service HandleRequestService avec injection de dépendance corrigée
    App\Service\tik\HandleRequestService:
        arguments:
            $em: '@doctrine.orm.default_entity_manager'
            $twig: '@Twig\Environment'
            $connectedUser: '@App\Entity\admin\utilisateur\User'
            $supportInfo: '@App\Entity\tik\DemandeSupportInformatique'
            $emailTikService: '@App\Service\tik\EmailTikService'
            $sessionService: '@App\Service\SessionManagerService'
        public: true

    # Service EmailTikService
    App\Service\tik\EmailTikService:
        arguments:
            $em: '@doctrine.orm.default_entity_manager'
            $twig: '@Twig\Environment'
            $emailService: '@App\Service\EmailService'
        public: true

    # Service HistoriqueOperationService avec injection de dépendance corrigée
    App\Service\historiqueOperation\HistoriqueOperationService:
        arguments:
            $em: '@doctrine.orm.default_entity_manager'
            $sessionService: '@App\Service\SessionManagerService'
            $typeDocumentId: 1 # Valeur par défaut, peut être surchargée
        public: true

