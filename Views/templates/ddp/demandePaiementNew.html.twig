{% extends "baseTemplate.html.twig" %}

{% block stylesheets%}
	<link href="{{ App.base_path }}/Views/css/new.css" rel="stylesheet"/>
	<link href="{{ App.base_path }}/Views/css/dit/ditInsertionOr.css" rel="stylesheet"/>
	<link href="{{ App.base_path }}/Views/css/ddp/demandePaiement.css" rel="stylesheet"/>

{% endblock %}

{% import "macroForm.html.twig" as macroForm %}

{% block content %}
	<div class="container-fluid">
		<div class="row">
			<div class="col-12 col-md-6">
				<div class="row">
					<div class="col-12 col-md-11">
						<h3 class="perso-titre">
							{% if id_type == 1 %}
								Formulaire Demande de paiement à l’avance
							{% else %}
								Formulaire Demande de paiement après arrivage
							{% endif %}
						</h3>
					</div>

					<div class=" col-12 col-md-1">
						<a href="{{ path("profil_acceuil")}}" class="tablinks p-2 btn btn-outline-warning" style="text-decoration: none;color:black">Retour</a>
					</div>
				</div>
				{{ form_start(form, {'attr': {'id': 'myForm'}}) }}
				{{ form_errors(form)}}
				<div class="row">
					<div class="col-12 col-md-2">
						{{ form_row(form.numeroFournisseur) }}
						<div id="suggestion-num-fournisseur" class="suggestions-container"></div>
						<div id="loader-num-fournisseur" class="spinner" style="display: none;">Chargement...</div>
						{{ form_row(form.modePaiement)}}

					</div>
					<div class="col-12 col-md-4">
						{{ form_row(form.beneficiaire)}}
						<div id="suggestion-nom-fournisseur" class="suggestions-container"></div>
						<div id="loader-nom-fournisseur" class="spinner" style="display: none;">Chargement...</div>
						{{ form_row(form.ribFournisseur) }}

					</div>
					<div class="col-12 col-md-3">
						{{ macroForm.agence_service_change(form.agence, form.service, 'spinner-service', 'service-container')}}
					</div>
					<div class="col-12 col-md-3">
						{{ form_row(form.contact)}}
						{{ form_row(form.montantAPayer)}}
					</div>
				</div>
				<div class="row">
					<div class="col-12 col-md-2">{{ form_row(form.devise)}}</div>

					<div class="col-12 col-md-10">{{ form_row(form.motif)}}</div>
				</div>
				<div class="row">
					<div class="col-12 col-md-4">
						{{ form_row(form.numeroFacture)}}
					</div>
					<div class="col-12 col-md-4">
						{{ form_row(form.numeroCommande)}}
						<div id="suggestion-num-commande" class="suggestions-container"></div>
						<div id="loader" style="display: none;">Chargement...</div>
					</div>

					<div
						class="col-12 col-md-4">
						{# <p><b>Listes des fichiers</b></p> #}
						<ul id="liste_fichiers" class="d-none"></ul>
						{# liste des fichiers #}
					</div>
				</div>
				<div class="row">
					<div class="col-12 col-md-4">
						{% if id_type == 1 %}
							<p>Veuillez insérer
								<strong>le proforma facture fournisseur *</strong>
							</p>
						{% else %}
							<p>Veuillez insérer
								<strong>le contrôle livraison *</strong>
							</p>
						{% endif %}
						{% include '/partials/_dropZoneFile.html.twig' with {'id': '1', 'form': form, 'fieldName': 'pieceJoint01'} %}
					</div>
					<div class="col-12 col-md-4">
						<p>
							Veuillez insérer
							<strong>
								rib fournisseur
							</strong>
						</p>
						{% include '/partials/_dropZoneFile.html.twig' with {'id': '2', 'form': form, 'fieldName': 'pieceJoint02'} %}
					</div>
					<div class="col-12 col-md-4">
						<p>
							<strong>
								Autre document
							</strong>
						</p>
						{% include '/partials/_dropZoneFile.html.twig' with {'id': '3', 'form': form, 'fieldName': 'pieceJoint03'} %}
					</div>
				</div>
				<div
					class="row">
					<!-- Debut affichage du tableau liste des factures-->
					<div class="row d-none" id="tableau_facture">>
					</div>
					<div class="row d-none" id="tableau_dossier"></div>

					<div class="d-flex justify-content-end">
						<button type="submit" class="btn bouton mt-2 ajout-overlay" data-confirmation data-form="#myForm" data-confirmation-message="Confirmez-vous l'envoi ?" data-confirmation-text="Vous êtes en train de soumettre une demande de paiement à validation dans DocuWare" data-warning-message="Merci de ne pas fermer la page pendant le traitement.">
							<i class="fas fa-save"></i>
							Enregistrer
						</button>
					</div>
					{{ form_end(form) }}
				</div>

			</div>
			<div class="col-12 col-md-6">

				<div id="file-viewer" style="border: 1px solid #ccc; padding: 10px;">
					<div class="row">
						<div id="pdf-preview-1" class="pdf-preview" style="display: none;">
							<embed id="pdf-embed-1" type="application/pdf" width="100%" height="500px">
						</div>
						<div id="pdf-preview-2" class="pdf-preview" style="display: none;">
							<embed id="pdf-embed-2" type="application/pdf" width="100%" height="500px">
						</div>
						<div id="pdf-preview-3" class="pdf-preview" style="display: none;">
							<embed id="pdf-embed-3" type="application/pdf" width="100%" height="500px">
						</div>
					</div>
				</div>
			</div>


		{% endblock %}

		{% block javascript %}
			<script type="module" src="{{ App.base_path }}/Views/js/ddp/demandePaiement.js"></script>
		{% endblock %}
