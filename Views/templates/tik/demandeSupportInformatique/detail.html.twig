{% extends 'baseTemplate.html.twig' %}

{% block title %} Détail sur le ticket {% endblock %}

{% block stylesheets %}
	<link href="/Hffintranet/Views/css/new.css" rel="stylesheet"/>
	<link href="/Hffintranet/Views/css/tik/supportInfo.css" rel="stylesheet">
{% endblock %}

{% import "macroForm.html.twig" as macroForm %}

{% block content %}
	<div class=" container">
		<div class="card">
			<div class="card-body">
				<div class="dropzone" id="dropzone">
					<div class="container">
						<div class="row">
							<div class="col-12 col-md-11">
								<h3 class="perso-titre">
									Détail du ticket
								</h3>
							</div>

							<div class=" col-12 col-md-1">
								<a href="{{ path("liste_tik_index")}}" class="tablinks p-2 btn btn-outline-warning" style="text-decoration: none;color:black">Retour</a>
							</div>
						</div>

						<div class="row">
							<div class="col-12 col-md-6">
								{{ macroForm.sousTitre('Demande', {class: 'sousTitre'})}}
								<div class="row">
									<div class="col-12 col-md-4">
                                        {{ macroForm.affichage('Nom du demandeur', tik.utilisateurDemandeur) }}
									</div>         
									<div class="col-12 col-md-4">
                                        {{ macroForm.affichage('Email du demandeur', tik.mailDemandeur) }}
									</div>
                                    <div class="col-12 col-md-4">
                                        {{ macroForm.affichage('N° parc PC', tik.parcInformatique) }}
									</div>
                                </div>
								<div class="col-12 col-md-12">
									{{ macroForm.affichage('Objet de la demande', tik.objetDemande) }}
								</div>
								<div class="col-12 col-md-12">
									{{ macroForm.affichageHTML('Détail de la demande', tik.detailDemande) }}
								</div>

								{{ macroForm.sousTitre('Pièces Jointes', {class: 'sousTitre'})}}
                                
                                {{ macroForm.affichageFile('Pièce jointe 01', tik.pieceJoint01)}}

                                {{ macroForm.affichageFile('Pièce jointe 02', tik.pieceJoint02)}}

                                {{ macroForm.affichageFile('Pièce jointe 03', tik.pieceJoint03)}}
							</div>

							<div class="col-12 col-md-6">
								{{ macroForm.sousTitre('TKI', {class: 'sousTitre'})}}
                                <div class="row">
									<div class="col-12 col-md-4">
										{{ macroForm.affichage('Numéro du ticket', tik.numeroTicket) }}
									</div>
									<div class="col-12 col-md-4">
										{{ macroForm.affichage('Date de création', tik.dateCreation|date('d/m/Y')) }}
									</div>
									<div class="col-12 col-md-4">
										{{ macroForm.affichage('Date souhaitée de livraison', tik.dateFinSouhaitee|date('d/m/Y')) }}
									</div>
								</div>

								<div class="row">
									{# DEBUT Agence et service #}
                                    {{ macroForm.sousTitre('Agence et Service', {class: 'sousTitre'})}}
                                    <div class="col-12 col-md-6">
										{{ macroForm.affichage('Débiteur', tik.agenceServiceDebiteur)}}
									</div>
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('Emetteur', tik.agenceServiceEmetteur)}}
									</div>
                                    {# FIN Agence et service #}
								</div>
							{% if autoriser %}
								{# DEBUT FORMULAIRE POUR LE VALIDATEUR #}
								{{ form_start(form, {'attr':{'id':'formTik'}}) }}

								{{ form_errors(form)}}
								{{ macroForm.sousTitre('Intervention', {class: 'sousTitre'})}}
								<div class="row">
									<div class="col-12 col-md-6">
										{{form_row(form.niveauUrgence)}}
									</div>
									<div class="col-12 col-md-6">
										{{form_row(form.nomIntervenant)}}
									</div>
								</div>

								{{ macroForm.sousTitre('Observation Ticket', {class: 'sousTitre'})}}
								<div class="row">
									<div class="col-12 col-md-4">
										{{ form_row(form.categorie) }}
									</div>
									<div class="col-12 col-md-4">
										{{ form_row(form.sousCategorie) }}
									</div>
									<div class="col-12 col-md-4">
										{{ form_row(form.autresCategorie) }}
									</div>
								</div>
							{% endif %}	
                    		</div>
						</div>
					</div>
					{% if autoriser %}
						<div class="d-flex justify-content-end">
							<button type="submit" class="btn bouton mx-3 text-white bg-danger" name="refuser" id="btn_refuser">
								<i class="fas fa-xmark"></i>
								Réfuser
							</button>
							<button type="submit" class="btn bouton" name="valider" id="btn_valider">
								<i class="fas fa-check"></i>
								Valider
							</button>
						</div>

						{{ form_end(form) }}
						{# FIN FORMULAIRE POUR LE VALIDATEUR #}
					{% endif %}
				</div>

			</div>
		</div>

		<div id="materielInfos"></div>
	</div>
{% endblock %}

{% block javascript %}
	<script src="/Hffintranet/Views/js/tik/tikSupport.js"></script>
{% endblock %}
