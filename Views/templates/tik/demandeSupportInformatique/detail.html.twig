{% extends 'baseTemplate.html.twig' %}

{% block nav %}{% endblock %}

{% block title %}
	Détail sur le ticket
{% endblock %}

{% block stylesheets %}
	<link href="/Hffintranet/Views/css/new.css" rel="stylesheet"/>
	<link href="/Hffintranet/Views/css/tik/supportInfo.css" rel="stylesheet">
{% endblock %}

{% import "macroForm.html.twig" as macroForm %}

{% block content %}
	<div class=" container mt-5">
		<div class="card mb-3">
			<div class="card-body">
				<div class="dropzone" id="dropzone">
					<div class="container">
						<div class="row">
							<div class="col-12 col-md-11">
								<h3 class="perso-titre">
									Détail du ticket
								</h3>
							</div>

							<div class=" col-12 col-md-1">
								<a href="{{ path("liste_tik_index")}}" class="tablinks p-2 btn btn-outline-warning" style="text-decoration: none;color:black">Retour</a>
							</div>
						</div>

						{# DEBUT PARTIE POUR DETAILS SEULEMENT #}
						<div class="row">
							{# DEBUT COLONNE 1 #}
							<div
								class="col-12 col-md-6">
								{# DEBUT TKI #}
								{{ macroForm.sousTitre('TKI', {class: 'sousTitre'})}}
								<div class="row">
									<div class="col-12 col-md-4">
										{{ macroForm.affichage('Numéro du ticket', tik.numeroTicket) }}
									</div>
									<div class="col-12 col-md-4">
										{{ macroForm.affichage('Date de création', tik.dateCreation|date('d/m/Y')) }}
									</div>
									<div class="col-12 col-md-4">
										{{ macroForm.affichage('Date souhaitée de livraison', tik.dateFinSouhaitee|date('d/m/Y')) }}
									</div>
								</div>
								{# FIN TKI #}

								{# DEBUT DEMANDE #}
								{{ macroForm.sousTitre('Demande', {class: 'sousTitre'})}}
								<div class="row">
									<div class="col-12 col-md-4">
										{{ macroForm.affichage('Nom du demandeur', tik.utilisateurDemandeur) }}
									</div>
									<div class="col-12 col-md-4">
										{{ macroForm.affichage('Email du demandeur', tik.mailDemandeur) }}
									</div>
									<div class="col-12 col-md-4">
										{{ macroForm.affichage('N° parc PC', tik.parcInformatique) }}
									</div>
								</div>
								<div class="col-12 col-md-12">
									{{ macroForm.affichage('Objet de la demande', tik.objetDemande) }}
								</div>
								<div class="col-12 col-md-12">
									{{ macroForm.affichageHTML('Détail de la demande', tik.detailDemande) }}
								</div>
								{# FIN DEMANDE #}
							</div>
							{# FIN COLONNE 1 #}

							{# DEBUT COLONNE 2 #}
							<div
								class="col-12 col-md-6">

								{# DEBUT Agence et service #}
								{{ macroForm.sousTitre('Agence et Service', {class: 'sousTitre'})}}
								<div class="row">
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('Débiteur', tik.agenceServiceDebiteur)}}
									</div>
									<div class="col-12 col-md-6">
										{{ macroForm.affichage('Emetteur', tik.agenceServiceEmetteur)}}
									</div>
								</div>
								{# FIN Agence et service #}

								{# DEBUT Pièces Jointes #}
								{{ macroForm.sousTitre('Pièces Jointes', {class: 'sousTitre'})}}

								{{ macroForm.affichageFile('Pièce jointe 01', tik.pieceJoint01)}}

								{{ macroForm.affichageFile('Pièce jointe 02', tik.pieceJoint02)}}

								{{ macroForm.affichageFile('Pièce jointe 03', tik.pieceJoint03)}}
								{# FIN Pièces Jointes #}
							</div>
							{# FIN COLONNE 2 #}

						{# FIN PARTIE POUR DETAILS SEULEMENT #}
						
						{# DEBUT PARTIE POUR VALIDATEUR OU INTERVENANT #}
						{% if autoriser %}
							{# DEBUT FORMULAIRE POUR VALIDATEUR OU INTERVENANT #}
							{{ form_start(form, {'attr':{'id':'formTik'}}) }}

							{{ form_errors(form)}}
							<div class="row">
								{# DEBUT COLONNE 1 #}
								<div class="col-12 col-md-6">
									<div class="row">
										{# DEBUT Intervention #}
										{{ macroForm.sousTitre('Intervention', {class: 'sousTitre'})}}
										<div class="col-12 col-md-4">
											{{ form_row(form.categorie) }}
											{{ form_row(form.sousCategorie) }}
											{{ form_row(form.autresCategorie) }}
										</div>
										<div class="col-12 col-md-4">
											{{form_row(form.niveauUrgence)}}
											{{form_row(form.intervenant)}}
										</div>
										<div class="col-12 col-md-4">
											{{form_row(form.dateDebutPlanning)}}
											{{form_row(form.dateFinPlanning)}}
										</div>
										{# FIN Intervention #}
									</div>
								</div>
								{# FIN COLONNE 1 #}

								{# DEBUT COLONNE 2 #}
								<div class="col-12 col-md-6">
									{# DEBUT Observation Ticket #}
									{{ macroForm.sousTitre('Observation Ticket', {class: 'sousTitre'})}}

									{{ form_row(form.commentaires) }}
									{# FIN Observation Ticket #}
								</div>
								{# FIN COLONNE 2 #}
							</div>

							<div class="d-flex justify-content-end">
								{% if validateur %}

									{# BOUTONS POUR VALIDATEUR #}
									<button type="submit" class="btn bouton mx-3 text-white bg-danger" name="refuser" id="btn_refuser">
										<i class="fas fa-xmark"></i>
										Réfuser
									</button>
									<button type="submit" class="btn bouton" name="valider" id="btn_valider">
										<i class="fas fa-check"></i>
										Valider
									</button>

								{% else %}

									{# BOUTONS POUR INTERVENANT #}
									<button type="submit" class="btn bouton mx-3 text-white bg-primary" name="transferer" id="btn_transferer">
										<i class="fas fa-paper-plane"></i>
										Transférer
									</button>
									<button type="submit" class="btn bouton" name="planifier" id="btn_planifier">
										<i class="fas fa-calendar"></i>
										Planifier
									</button>

								{% endif %}
							</div>
							{{ form_end(form) }}
							{# FIN FORMULAIRE POUR VALIDATEUR OU INTERVENANT #}
						{% endif %}
						{# FIN PARTIE POUR VALIDATEUR OU INTERVENANT #}
						</div>
					</div>
				</div>
			</div>
		</div>

		<div id="materielInfos"></div>
	</div>
{% endblock %}

{% block footer %}{% endblock %}

{% block javascript %}
	{% if autoriser %}
		<script src="/Hffintranet/Views/js/tik/tikDetail.js"></script>
	{% else %}
		<script src="/Hffintranet/Views/js/tik/tikSupport.js"></script>
	{% endif %}
{% endblock %}
