{% extends "baseTemplate.html.twig" %}

{% block title %}
	Soumission Facture et Bon de Livraison
{% endblock %}

{% block stylesheets %}
	<link href="{{ App.base_path }}/Views/css/new.css?v=2025.10.22.08.00" rel="stylesheet"/>
	<link href="{{ App.base_path }}/Views/css/da/soumissionBC/soumiBc.css?v=2025.10.22.08.00" rel="stylesheet"/>
	<link href=" {{ App.base_path }}/Views/css/bl/blsoumission.css?v=2025.10.22.08.00" rel="stylesheet"/>
{% endblock %}

{% block content %}
	<div class="container mt-6">
		<div class="card">
			<div class="card-body">
				<div class="container">
					<div class="row">
						<div class="col-12 col-md-11">
							<h3 class="perso-titre">
								SOUMISSION FACTURE ET BON DE LIVRAISON
							</h3>
						</div>
						<div class=" col-12 col-md-1">
							<a href="{{ path("list_da")}}" class="tablinks p-2 btn btn-outline-warning " style="text-decoration: none;color:black">Retour</a>
						</div>
					</div>
					{{ form_start(form, {'attr': {'enctype': 'multipart/form-data', 'id': 'myForm'}}) }}
					{{ form_errors(form)}}
					<div class="row">
						<div class="col-12 col-md-3">
							{{ form_row(form.numeroCde) }}
							{{ form_errors(form.numeroCde) }}
						</div>
						<div class="col-12 col-md-3">
							{{ form_row(form.totalMontantCommande, { 'attr':{'class':'div-disabled fw-bold text-end fs-6'}}) }}
							{{ form_errors(form.totalMontantCommande) }}
						</div>
						<div class="col-12 col-md-3"></div>
						<div class="col-12 col-md-3"></div>
					</div>
					{# =========================== #}
					<div class="row">
						<div class="col-12 col-md-6 bg-Light shadow-sm rounded">
							{% include "/da/shared/cdeFrn/_tableauDdpa.html.twig" %}
						</div>
						<div class="col-12 col-md-6 bg-Light shadow-sm rounded">
							{% include "/da/shared/cdeFrn/_tableauSituationReception.html.twig" %}
						</div>
					</div>
					{# ============================ #}
					<hr>
					<div class="row">
						<div class="col-12 col-md-3">
							<p>Veuillez insérer
								<strong>la facture et le bon de livraison à valider *</strong>
							</p>
							{% include '/partials/_dropZoneFile.html.twig' with {'id': '1', 'form': form, 'fieldName': 'pieceJoint1'} %}
						</div>
						<div class="col-12 col-md-3">
							<p>Insérer
								<strong>les autres fichiers ici</strong>
							</p>
							{% include '/partials/_dropZoneFileMultiple.html.twig' with {'id': '2', 'form': form, 'fieldName': 'pieceJoint2'} %}
						</div>
					</div>
					<div class="d-flex justify-content-end">
						<button type="submit" class="btn bouton mt-2" data-confirmation data-form="#myForm" data-confirmation-message="Confirmez-vous l'envoi ?" data-confirmation-text="Vous êtes en train de soumettre une facture+bl à validation dans DocuWare" data-warning-message="Merci de ne pas fermer la page pendant le traitement.">
							<i class="fas fa-save"></i>
							Enregistrer
						</button>
					</div>
					{{ form_end(form) }}
				</div>
			</div>
		</div>


		<div
			id="file-viewer" class="mt-3">
			<!-- Onglets -->
			<ul class="nav nav-tabs" id="pdfTabs" role="tablist">
				<li class="nav-item" role="presentation">
					<button class="nav-link active" id="tab1-tab" data-bs-toggle="tab" data-bs-target="#tab1" type="button" role="tab">
						Facture + Bon livraison
					</button>
				</li>
				<li class="nav-item" role="presentation">
					<button class="nav-link" id="tab2-tab" data-bs-toggle="tab" data-bs-target="#tab2" type="button" role="tab">
						Autres fichiers
					</button>
				</li>
			</ul>

			<!-- Contenu des onglets -->
			<div
				class="tab-content border border-top-0 p-3" id="pdfTabContent">
				<!-- Tab 1 -->
				<div class="tab-pane fade show active" id="tab1" role="tabpanel" aria-labelledby="tab1-tab">
					<div id="file-list-1" class="mt-3"></div>
				</div>
				<!-- Tab 2 -->
				<div class="tab-pane fade" id="tab2" role="tabpanel" aria-labelledby="tab2-tab">
					<div id="file-list-2" class="mt-3"></div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
{% block javascript %}
	<script src="{{ App.base_path }}/Views/js/da/soumission/soumiFacBlDdpa.js?v=2025.10.22.08.00" type="module"></script>
{% endblock %}
