{% extends "baseTemplate.html.twig" %}

{% block title %}
	Validation d’une DA Réappro
{% endblock %}

{% block stylesheets %}
	<link href="{{ App.base_path }}/Views/css/new.css?v=2025.10.22.08.00" rel="stylesheet"/>
	<link href="{{ App.base_path }}/Views/css/da/style.css?v=2025.10.22.08.00" rel="stylesheet"/>
	<link href="{{ App.base_path }}/Views/css/da/list.css?v=2025.10.22.08.00" rel="stylesheet"/>
	<link href="{{ App.base_path }}/Views/css/da/detail.css?v=2025.10.22.08.00" rel="stylesheet"/>
{% endblock %}

{% import "macroForm.html.twig" as macroForm %}

{% block overlay %}
	{% include "/shared/_overlay.html.twig"  %}
{% endblock %}

{% block content %}
	<div class="container-spaced">
		<div class="card">
			<div class="card-body">
				<div class="container-fluid">
					<h3 class="perso-titre">
						Affectation de la DA n°
						{{ demandeApproParent.numeroDemandeAppro }}
					</h3>
					<div class="row">
						<div class="col-12 col-md-6">
							{{ macroForm.sousTitre('Information sur la demande') }}
							{{ macroForm.affichage2('Objet de la demande', demandeApproParent.objetDal, 'mb-2') }}
							{{ macroForm.affichage2('Détail de la demande', demandeApproParent.detailDal, 'h-90 mb-2') }}
							{{ macroForm.affichage2('Date fin souhaitée', demandeApproParent.dateFinSouhaite|date('d/m/Y'), 'mb-2') }}
						</div>
						<div class="col-12 col-md-6">
							{{ macroForm.sousTitre('Agence et service') }}
							<div class="row">
								<div class="col-6 col-md-6">
									{{ macroForm.sousTitre('Emetteur') }}
									{{ macroForm.affichage2('Agence', demandeApproParent.agenceEmetteur.codeAgence ~ ' ' ~ demandeApproParent.agenceEmetteur.libelleAgence, 'mb-2') }}
									{{ macroForm.affichage2('Service', demandeApproParent.serviceEmetteur.codeService ~ ' ' ~  demandeApproParent.serviceEmetteur.libelleService, 'mb-2') }}
								</div>
								<div class="col-6 col-md-6">
									{{ macroForm.sousTitre('Débiteur') }}
									{{ macroForm.affichage2('Agence Débiteur', demandeApproParent.agenceDebiteur.codeAgence ~ ' ' ~ demandeApproParent.agenceDebiteur.libelleAgence, 'mb-2') }}
									{{ macroForm.affichage2('Service Débiteur', demandeApproParent.serviceDebiteur.codeService ~ ' ' ~  demandeApproParent.serviceDebiteur.libelleService, 'mb-2') }}
									{{ macroForm.affichage2('Centrale rattachée à la DA', demandeApproParent.desiCentrale ?? '-', 'mb-2') }}
								</div>
							</div>
						</div>
					</div>

					{{ macroForm.sousTitre('Affectation des articles demandés') }}
					<table class="table text-center mt-3 align-middle">
						<thead class="table-dark align-middle">
							<tr>
								<th width="7%">Constructeur</th>
								<th width="13%">Référence</th>
								<th>Désignation</th>
								<th width="10%" class="text-end pe-3">PU</th>
								<th width="10%">Qté demandée</th>
								<th width="10%">Qté validée</th>
								<th width="10%" class="text-end pe-3">Montant</th>
							</tr>
						</thead>
						<tbody>
							{% for dal in demandeApproParent.DAL %}
								<tr>
									<td>{{ macroForm.affichageSimple(dal.artConstp, 'text-center') }}</td>
									<td>{{ macroForm.affichageSimple(dal.artRefp, 'text-center') }}</td>
									<td>{{ macroForm.affichageSimple(dal.artDesi, 'text-start') }}</td>
									<td>{{ macroForm.affichageSimple(dal.PUFormatted, 'text-end') }}</td>
									<td>{{ macroForm.affichageSimple(dal.qteDem, 'text-center qte-dem-da-reappro', {"data-qte-dem": dal.qteDem, "data-qte-valide": dal.qteValAppro}) }}</td>
									<td>{{ macroForm.affichageSimple(dal.qteValAppro, 'text-center') }}</td>
									<td>{{ macroForm.affichageSimple(dal.montantFormatted, 'text-end') }}</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
{% endblock %}

{% block javascript %}{% endblock %}
