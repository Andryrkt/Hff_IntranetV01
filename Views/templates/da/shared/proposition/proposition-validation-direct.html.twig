<div class="card border-top-left-radius-0">
	<div class="card-body">
		<div class="container-fluid">
			<div class="row">
				<h3 class="perso-titre">
					<div class="urgency-level">{{ demandeAppro.niveauUrgence }}</div>
					Validation et proposition
					{{ numDa }}
				</h3>
			</div>
			<div class="tab-content">
				{% for DAL in demandeAppro.DAL %}
					{{ include('da/shared/proposition/_article-direct.html.twig', { article: DAL, totalPage: demandeAppro.DAL|length }) }}
				{% endfor %}
			</div>
		</div>
	</div>
	<hr class="m-0">
	<div class="card-body pt-2 pb-1">
		<div class="container-fluid">
			{{ form_start(form, { 'attr': { 'id': 'myForm' } }) }}
			<input type="hidden" name="refs" id="refsHiddenInput">
			<div id="child-prototype" style="display: none;">
				{{ form_widget(form.DALR.vars.prototype)|raw }}
			</div>
			<div class="{{ nePeutPasModifier or estCreateurDaDirecte ? 'd-none' : ''}}">
				{{ form_row(form.observation)}}
				<div class="d-none">
					{{ form_row(form.statutChange)}}
				</div>
			</div>
			<div class="d-flex justify-content-between mt-2">
				<div class="d-flex">
					<div class="me-3">
						<button type="submit" class="btn bouton mb-2 d-none" id="envoyerSelections" name="enregistrer" data-da-directe-appro={{ estCreateurDaDirecte and estAppro }}>
							Envoyer proposition au service émetteur
							<i class="fa-solid fa-square-arrow-up-right"></i>
						</button>
					</div>
					<div>
						<button type="submit" class="btn bouton-brouillon mb-2 d-none" id="enregistrerDraft" name="brouillon">
							Enregistrer provisoirement les propositions
							<i class="fas fa-floppy-disk"></i>
						</button>
					</div>
					<div>
						<a href="{{ path("da_edit_direct", {id: demandeAppro.id})}}" class="btn bouton mb-2 {{ estCreateurDaDirecte and not nePeutPasModifier ? '' : 'd-none'}}" target="_blank">
							Modifier la demande
						</a>
						<button type="submit" class="btn bouton mb-2 d-none" name="observation">
							Envoyer l'observation
							<i class="fa-solid fa-paper-plane"></i>
						</button>
					</div>
				</div>
				<div class="d-flex">
					<button type="submit" class="btn bouton mb-2 d-none" id="validerSelections" name="valider">
						Soumettre à validation
						<i class="fa-solid fa-square-arrow-up-right"></i>
					</button>
				</div>
				<div id="validationButtons">
					<div>
						<button type="submit" class="btn bouton mb-2 {{ estCreateurDaDirecte and not nePeutPasModifier ? '' : 'd-none'}}" id="envoyerSelections" name="changement">
							Soumettre à validation
							<i class="fa-solid fa-square-arrow-up-right"></i>
						</button>
					</div>

					<div class="d-flex justify-content-end d-none">
						<div class="mt-3">
							{{ form_row(form.estValidee)}}
						</div>
						{{ form_end(form) }}
						{{ form_start(formValidation) }}
						{{ form_row(formValidation.prixUnitaire) }}
						{{ form_row(formValidation.refsValide) }}
						<div>
							<button type="button" class="btn bouton mt-2 ms-3 d-none" id="bouton_ok">OK</button>
						</div>
						{{ form_end(formValidation) }}
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
